# application-docker.properties
# This file is loaded when SPRING_PROFILES_ACTIVE=docker

spring.application.name=chatapi
server.port=5050

# MongoDB Configuration
spring.mongodb.uri=${SPRING_DATA_MONGODB_URI}
spring.data.mongodb.auto-index-creation=true

# JWT Configuration
jwt.secret=${JWT_SECRET}
jwt.expiration-ms=${JWT_EXPIRATION_MS}

# Kafka Configuration - Docker internal network
spring.kafka.bootstrap-servers=${SPRING_KAFKA_BOOTSTRAP_SERVERS}

# Kafka Producer Configuration
spring.kafka.producer.key-serializer=${SPRING_KAFKA_PRODUCER_KEY_SERIALIZER}
spring.kafka.producer.value-serializer=${SPRING_KAFKA_PRODUCER_VALUE_SERIALIZER}
spring.kafka.producer.acks=${SPRING_KAFKA_PRODUCER_ACKS}
spring.kafka.producer.retries=${SPRING_KAFKA_PRODUCER_RETRIES}
spring.kafka.producer.properties.linger.ms=10
spring.kafka.producer.properties.batch.size=16384

# Kafka Consumer Configuration with Error Handling
spring.kafka.consumer.group-id=${SPRING_KAFKA_CONSUMER_GROUP_ID}
spring.kafka.consumer.auto-offset-reset=${SPRING_KAFKA_CONSUMER_AUTO_OFFSET_RESET}
spring.kafka.consumer.enable-auto-commit=true
spring.kafka.consumer.key-deserializer=${SPRING_KAFKA_CONSUMER_KEY_DESERIALIZER}
spring.kafka.consumer.value-deserializer=${SPRING_KAFKA_CONSUMER_VALUE_DESERIALIZER}

# ErrorHandlingDeserializer delegates
spring.kafka.consumer.properties.spring.deserializer.key.delegate.class=${SPRING_KAFKA_CONSUMER_PROPERTIES_SPRING_DESERIALIZER_KEY_DELEGATE_CLASS}
spring.kafka.consumer.properties.spring.deserializer.value.delegate.class=${SPRING_KAFKA_CONSUMER_PROPERTIES_SPRING_DESERIALIZER_VALUE_DELEGATE_CLASS}

# JsonDeserializer Configuration
spring.kafka.consumer.properties.spring.json.trusted.packages=${SPRING_KAFKA_CONSUMER_PROPERTIES_SPRING_JSON_TRUSTED_PACKAGES}
spring.kafka.consumer.properties.spring.json.use.type.info.headers=${SPRING_KAFKA_CONSUMER_PROPERTIES_SPRING_JSON_USE_TYPE_INFO_HEADERS}
spring.kafka.consumer.properties.spring.json.value.default.type=${SPRING_KAFKA_CONSUMER_PROPERTIES_SPRING_JSON_VALUE_DEFAULT_TYPE}

# Additional Consumer Properties
spring.kafka.consumer.properties.max.poll.records=100
spring.kafka.consumer.properties.session.timeout.ms=30000
spring.kafka.consumer.properties.heartbeat.interval.ms=10000

# Custom Kafka Topic
kafka.topic.chat-messages=${KAFKA_TOPIC_CHAT_MESSAGES}

# Swagger/OpenAPI Configuration
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.swagger-ui.tryItOutEnabled=true

# Actuator endpoints
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.health.mongodb.enabled=false

# Logging
logging.level.com.yappifychatapp=${LOGGING_LEVEL_COM_YAPPIFYCHATAPP}
logging.level.org.springframework.kafka=${LOGGING_LEVEL_ORG_SPRINGFRAMEWORK_KAFKA}
logging.level.org.apache.kafka=WARN
logging.level.org.springframework.kafka.listener=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# WebSocket Configuration
spring.websocket.message-size-limit=65536
spring.websocket.send-buffer-size-limit=524288
spring.websocket.send-time-limit=20000